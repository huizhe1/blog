<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><style>.pace .pace-progress{background:#1e92fb;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1e92fb,0 0 5px #1e92fb}.pace .pace-activity{border-top-color:#1e92fb;border-left-color:#1e92fb}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet"><link href="/css/main.css?v=5.1.3" rel="stylesheet"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/hero_h_32.ico?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/hero_h-16.ico?v=5.1.3"><link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222"><meta name="keywords" content="JAVA,"><link rel="alternate" href="/atom.xml" title="Huizhe" type="application/atom+xml"><meta name="description" content="因为这周入门 JAVA EE，所以采用了原生的写法，没有使用 Maven 对应用进行项目管理，以及自动构建，所以踩的坑也就比较大了，还有就是效率着实不怎么高。。。还有一个点就是使用 IDEA 没多久，所以对其用法也还不怎么熟悉，这个也是效率不高的原因"><meta name="keywords" content="JAVA"><meta property="og:type" content="article"><meta property="og:title" content="记一次踩坑过程—非Maven项目"><meta property="og:url" content="https://www.huizhe.xyz/javaProject/index.html"><meta property="og:site_name" content="Huizhe"><meta property="og:description" content="因为这周入门 JAVA EE，所以采用了原生的写法，没有使用 Maven 对应用进行项目管理，以及自动构建，所以踩的坑也就比较大了，还有就是效率着实不怎么高。。。还有一个点就是使用 IDEA 没多久，所以对其用法也还不怎么熟悉，这个也是效率不高的原因"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://static.huizhe.xyz/article-images/message.png"><meta property="og:updated_time" content="2018-08-19T09:25:31.604Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="记一次踩坑过程—非Maven项目"><meta name="twitter:description" content="因为这周入门 JAVA EE，所以采用了原生的写法，没有使用 Maven 对应用进行项目管理，以及自动构建，所以踩的坑也就比较大了，还有就是效率着实不怎么高。。。还有一个点就是使用 IDEA 没多久，所以对其用法也还不怎么熟悉，这个也是效率不高的原因"><meta name="twitter:image" content="https://static.huizhe.xyz/article-images/message.png"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.3",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.huizhe.xyz/javaProject/"><title>记一次踩坑过程—非Maven项目 | Huizhe</title></head><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("uO3UNSROyYwoFkpDBx7A6nBs-gzGzoHsz","kUDFwWRFOx1lQbjHOz7oSVDD")</script><script>function showTime(e){var t=new AV.Query(e);$(".leancloud_visitors").each(function(){var r=$(this).attr("id").trim();t.equalTo("url",r),t.find({success:function(e){if(0!=e.length)for(var t=0;t<e.length;t++){var n=e[t];o=$(document.getElementById(r)).text()+": "+n.get("time");$(document.getElementById(r)).text(o)}else{var o=$(document.getElementById(r)).text()+": 0";$(document.getElementById(r)).text(o)}},error:function(e,t){console.log("Error: "+t.code+" "+t.message)}})})}function addCount(o){o=AV.Object.extend("Counter");url=$(".leancloud_visitors").attr("id").trim(),title=$(".leancloud_visitors").attr("data-flag-title").trim();var e=new AV.Query(o);e.equalTo("url",url),e.find({success:function(e){if(0<e.length){var t=e[0];t.fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){var t=$(document.getElementById(url)).text()+": "+e.get("time");$(document.getElementById(url)).text(t)},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var n=new o;n.set("title",title),n.set("url",url),n.set("time",1),n.save(null,{success:function(e){console.log("newcounter.get('time')="+e.get("time"));var t=$(document.getElementById(url)).text()+": "+e.get("time");$(document.getElementById(url)).text(t)},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Huizhe</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">记录一些学习心得</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.huizhe.xyz/javaProject/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="灰者"><meta itemprop="description" content=""><meta itemprop="image" content="/images/mylogo.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Huizhe"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">记一次踩坑过程—非Maven项目</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-19T16:48:22+08:00">2018-08-19</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JAVA/" itemprop="url" rel="index"><span itemprop="name">JAVA</span></a></span></span> <span id="/javaProject/" class="leancloud_visitors" data-flag-title="记一次踩坑过程—非Maven项目"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">3,710</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">14 分钟</span></div><div class="post-description">因为这周入门 JAVA EE，所以采用了原生的写法，没有使用 Maven 对应用进行项目管理，以及自动构建，所以踩的坑也就比较大了，还有就是效率着实不怎么高。。。还有一个点就是使用 IDEA 没多久，所以对其用法也还不怎么熟悉，这个也是效率不高的原因</div></div></header><div class="post-body" itemprop="articleBody"><p>因为我的博客系统是采用 <a href="https://hexo.io/zh-cn/index.html" target="_blank" rel="external">Hexo</a> 搭配 <a href="https://theme-next.iissnan.com/" target="_blank" rel="external">Next</a> 主题，是纯静态页面的，所有就想着把博客用 java 写成一个动态页面，既可以当作是练习，也算是自己对这一个多月来的实践。<br>所以上周就开始动工，先把几个页面提取出来了，先提取了，后面的就是数据绑定的事了。<br>所以再提取完页面之后，再找了个后台管理模板，对博文等等进行处理。<br>附上后台管理模板 <a href="https://adminlte.io/" target="_blank" rel="external">AdminLTE</a></p><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p>这里有个博文比较详细，前两天如果照着这个博文来，可能就不会中一些招了吧<br><a href="https://www.cnblogs.com/junhuawang/p/6610969.html" target="_blank" rel="external">IDea发布JavaWeb项目 详解一</a></p><p>照着这个打，就可以完成入门的 Hello World 的一个JSP页面了。</p><h3 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h3><ol><li>定义：其实 Servlet 是遵循 Servlet 开发的一个java类。</li><li>Servlet 是由服务器调用的，运行在 <strong>服务器</strong> 端</li><li>作用： 处理浏览器带来的HTTP请求，并返回一个响应给浏览器，从而实现浏览器和服务器的交互。使用 Servlet ，我们就不用特意用一个JSP页面，去接受http请求并相应。</li><li>Servlet 是非线程安全的，涉及到变量共享的时候，要记得加锁或者采用同步方法。</li></ol><h4 id="HTTP-协议"><a href="#HTTP-协议" class="headerlink" title="HTTP 协议"></a>HTTP 协议</h4><ol><li>是计算机通过网络进行通信的规则</li><li>是一个基于请求与响应，无状态，应用层的协议</li><li>常基于 TCP/IP 协议传输数据</li></ol><h4 id="HTTP-请求报文"><a href="#HTTP-请求报文" class="headerlink" title="HTTP 请求报文"></a>HTTP 请求报文</h4><p>一个 HTTP 请求报文由请求行、请求头部、空行和请求数据 4个部分组成。</p><p><img src="https://static.huizhe.xyz/article-images/message.png" alt="报文格式"></p><ul><li>请求行 分为三个部分<ol><li>请求方法<br>HTTP/1.1 定义的请求方法由8 种：<ul><li>GET</li><li>POST</li><li>PUT</li><li>DELETE</li><li>PATCH</li><li>HEAD</li><li>OPTIONS</li><li>TRACE<br>最常使用的是 GET 和 POST 方法。<br>RESTful 接口的话，一般会使用到 <strong>GET、POST、DELETE、PUT/PATCH</strong></li></ul></li><li>请求地址<br>URL： 统一资源定位符 Uniform Resource Locator URL， 是一种自愿位置的抽象唯一识别方法。<br>组成： &lt;协议&gt;://&lt;主机&gt;:&lt;端口&gt;/&lt;路径&gt;<br>端口为80时，可省略，https协议使用的是443端口</li><li>协议版本<br>格式为：HTTP/主版本号.次版本号，常用的有HTTP/1.0和HTTP/1.1</li></ol></li><li>请求头部<br>请求头部为请求报文添加了一些附加信息，由 键/值 对组成，每行一对，用 <strong>:</strong> 分隔<br>常见请求头：</li></ul><table><thead><tr><th>请求头</th><th>说明</th></tr></thead><tbody><tr><td>Host</td><td>接受请求的服务器地址</td></tr><tr><td>User-Agent</td><td>发送请求的应用程序名称</td></tr><tr><td>Connection</td><td>指定与连接相关的属性</td></tr><tr><td>Accept-Charset</td><td>通知服务端可以发送的编码格式</td></tr><tr><td>Accept-Encoding</td><td>通知服务端可以发送的数据压缩格式</td></tr><tr><td>Accept-Language</td><td>通知服务端可以发送的语言</td></tr><tr><td>Cookie</td><td>客户机通过这个头可以向服务器带数据</td></tr></tbody></table><ul><li>空行，表示请求头部结束</li><li>请求数据（可选部分）</li></ul><h4 id="HTTP-响应报文"><a href="#HTTP-响应报文" class="headerlink" title="HTTP 响应报文"></a>HTTP 响应报文</h4><p>HTTP 响应报文主要由 状态行、响应头部、空行以及响应数据组成。</p><ul><li>状态行<ul><li>协议版本<br>协议版本于请求报文的一致</li><li>状态码<br>状态码为3位数字</li></ul></li></ul><table><thead><tr><th>状态码</th><th>状态码描述</th></tr></thead><tbody><tr><td>1xx</td><td>指示信息–表示请求已接收，继续处理。</td></tr><tr><td>2xx</td><td>成功–表示请求已被成功接收、理解、接受。</td></tr><tr><td>3xx</td><td>重定向–要完成请求必须进行更进一步的操作。</td></tr><tr><td>4xx</td><td>客户端错误–请求有语法错误或请求无法实现。</td></tr><tr><td>5xx</td><td>服务器端错误–服务器未能实现合法的请求。</td></tr></tbody></table><ul><li>状态码描述</li><li>常见状态码</li></ul><table><thead><tr><th>状态码</th><th>说明</th></tr></thead><tbody><tr><td>200</td><td>响应成功</td></tr><tr><td>302</td><td>跳转，跳转地址由响应头种的Location属性指定</td></tr><tr><td>400</td><td>客户端请求有语法错误，不能被服务器识别</td></tr><tr><td>403</td><td>服务器接受到请求，但是拒绝提供服务</td></tr><tr><td>404</td><td>请求资源不存在</td></tr><tr><td>500</td><td>服务器内部错误</td></tr><tr><td></td></tr></tbody></table><ul><li>响应头部<br>与请求头部类似，附上常见响应头部信息</li></ul><table><thead><tr><th>响应头</th><th>说明</th></tr></thead><tbody><tr><td>Server</td><td>服务器应用程序软件的名称和版本</td></tr><tr><td>Content-Type</td><td>响应正文的类型</td></tr><tr><td>Content-Length</td><td>响应正文长度</td></tr><tr><td>Content-Charset</td><td>响应正文使用的编码</td></tr><tr><td>Content-Encoding</td><td>响应正文使用的数据压缩格式</td></tr><tr><td>Content-Language</td><td>响应正文使用的语言</td></tr></tbody></table><ul><li>响应数据<br>用于存放需要返回给客户端的数据信息</li></ul><h4 id="HttpServletRequest-对象"><a href="#HttpServletRequest-对象" class="headerlink" title="HttpServletRequest 对象"></a>HttpServletRequest 对象</h4><p>HttpServletRequest 对象代表 客户端的请求，http请求头部中的所有信息都封装在这个对象中。</p><ol><li>获取浏览器信息<ul><li>getRequestURL方法返回客户端发出请求时的完整URL</li><li>getRequestURI方法返回请求行中的资源名部分</li><li>getQueryString 方法返回请求行中的参数部分</li><li>getPathInfo方法返回请求URL中的额外路径信息。额外路径信息是请求URL中的位于Servlet的路径之后和查询参数之前的内容，它以“/”开头</li><li><strong>getRemoteAddr方法返回发出请求的客户机的IP地址</strong></li><li>getRemoteHost方法返回发出请求的客户机的完整主机名</li><li>getRemotePort方法返回客户机所使用的网络端口号</li><li>getLocalAddr方法返回WEB服务器的IP地址</li><li>getLocalName方法返回WEB服务器的主机名</li></ul></li><li>获取浏览器请求头<ul><li><strong>getHeader方法</strong></li><li>getHeaders方法</li><li>getHeaderNames方法</li></ul></li><li>获取浏览器请求参数<ul><li><strong>getParameter方法</strong></li><li><strong>getParameterValues（String name）方法</strong></li><li>getParameterNames方法</li><li>getParameterMap方法</li></ul></li></ol><h4 id="HttpServletResponse-对象"><a href="#HttpServletResponse-对象" class="headerlink" title="HttpServletResponse 对象"></a>HttpServletResponse 对象</h4><p>HttpServletResponse 对象代表 客户端的响应，这个对象中封装了向客户端发送数据、发送响应头，发送响应状态码的方法</p><ol><li>负责向客户端(浏览器)发送数据<ul><li>getOutputStream()</li><li>getWriter()</li></ul></li><li>负责向客户端(浏览器)发送响应头<ul><li>addDateHeader(String s, long l)</li><li>addHeader(String name, String value)</li><li>addIntHeader(String name, int value)</li><li>containsHeader(String name)</li></ul></li><li>负责向客户端(浏览器)发送响应状态码<ul><li>setStatus(int sc)</li></ul></li><li>响应状态码的常量<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> SC_CONTINUE = <span class="number">100</span>;</div><div class="line"><span class="keyword">int</span> SC_SWITCHING_PROTOCOLS = <span class="number">101</span>;</div><div class="line"><span class="keyword">int</span> SC_OK = <span class="number">200</span>;</div><div class="line"><span class="keyword">int</span> SC_CREATED = <span class="number">201</span>;</div><div class="line"><span class="keyword">int</span> SC_ACCEPTED = <span class="number">202</span>;</div><div class="line"><span class="keyword">int</span> SC_NON_AUTHORITATIVE_INFORMATION = <span class="number">203</span>;</div><div class="line"><span class="keyword">int</span> SC_NO_CONTENT = <span class="number">204</span>;</div><div class="line"><span class="keyword">int</span> SC_RESET_CONTENT = <span class="number">205</span>;</div><div class="line"><span class="keyword">int</span> SC_PARTIAL_CONTENT = <span class="number">206</span>;</div><div class="line"><span class="keyword">int</span> SC_MULTIPLE_CHOICES = <span class="number">300</span>;</div><div class="line"><span class="keyword">int</span> SC_MOVED_PERMANENTLY = <span class="number">301</span>;</div><div class="line"><span class="keyword">int</span> SC_MOVED_TEMPORARILY = <span class="number">302</span>;</div><div class="line"><span class="keyword">int</span> SC_FOUND = <span class="number">302</span>;</div><div class="line"><span class="keyword">int</span> SC_SEE_OTHER = <span class="number">303</span>;</div><div class="line"><span class="keyword">int</span> SC_NOT_MODIFIED = <span class="number">304</span>;</div><div class="line"><span class="keyword">int</span> SC_USE_PROXY = <span class="number">305</span>;</div><div class="line"><span class="keyword">int</span> SC_TEMPORARY_REDIRECT = <span class="number">307</span>;</div><div class="line"><span class="keyword">int</span> SC_BAD_REQUEST = <span class="number">400</span>;</div><div class="line"><span class="keyword">int</span> SC_UNAUTHORIZED = <span class="number">401</span>;</div><div class="line"><span class="keyword">int</span> SC_PAYMENT_REQUIRED = <span class="number">402</span>;</div><div class="line"><span class="keyword">int</span> SC_FORBIDDEN = <span class="number">403</span>;</div><div class="line"><span class="keyword">int</span> SC_NOT_FOUND = <span class="number">404</span>;</div><div class="line"><span class="keyword">int</span> SC_METHOD_NOT_ALLOWED = <span class="number">405</span>;</div><div class="line"><span class="keyword">int</span> SC_NOT_ACCEPTABLE = <span class="number">406</span>;</div><div class="line"><span class="keyword">int</span> SC_PROXY_AUTHENTICATION_REQUIRED = <span class="number">407</span>;</div><div class="line"><span class="keyword">int</span> SC_REQUEST_TIMEOUT = <span class="number">408</span>;</div><div class="line"><span class="keyword">int</span> SC_CONFLICT = <span class="number">409</span>;</div><div class="line"><span class="keyword">int</span> SC_GONE = <span class="number">410</span>;</div><div class="line"><span class="keyword">int</span> SC_LENGTH_REQUIRED = <span class="number">411</span>;</div><div class="line"><span class="keyword">int</span> SC_PRECONDITION_FAILED = <span class="number">412</span>;</div><div class="line"><span class="keyword">int</span> SC_REQUEST_ENTITY_TOO_LARGE = <span class="number">413</span>;</div><div class="line"><span class="keyword">int</span> SC_REQUEST_URI_TOO_LONG = <span class="number">414</span>;</div><div class="line"><span class="keyword">int</span> SC_UNSUPPORTED_MEDIA_TYPE = <span class="number">415</span>;</div><div class="line"><span class="keyword">int</span> SC_REQUESTED_RANGE_NOT_SATISFIABLE = <span class="number">416</span>;</div><div class="line"><span class="keyword">int</span> SC_EXPECTATION_FAILED = <span class="number">417</span>;</div><div class="line"><span class="keyword">int</span> SC_INTERNAL_SERVER_ERROR = <span class="number">500</span>;</div><div class="line"><span class="keyword">int</span> SC_NOT_IMPLEMENTED = <span class="number">501</span>;</div><div class="line"><span class="keyword">int</span> SC_BAD_GATEWAY = <span class="number">502</span>;</div><div class="line"><span class="keyword">int</span> SC_SERVICE_UNAVAILABLE = <span class="number">503</span>;</div><div class="line"><span class="keyword">int</span> SC_GATEWAY_TIMEOUT = <span class="number">504</span>;</div><div class="line"><span class="keyword">int</span> SC_HTTP_VERSION_NOT_SUPPORTED = <span class="number">505</span>;</div></pre></td></tr></table></figure></li></ol><h4 id="转发和重定向"><a href="#转发和重定向" class="headerlink" title="转发和重定向"></a>转发和重定向</h4><ol><li>转发：<br>转发是由<strong>服务器</strong>进行跳转的。浏览器的地址栏是没有发生变化的。即转发是对浏览器透明的。<br>实现转发只是一次 http 请求，一次转发中的 request 和 response 对象都是同一个</li><li>重定向：<br>重定向是由<strong>浏览器</strong>进行跳转的。浏览器的地址是会发生变化的。<br>由浏览器进行页面跳转实现 <strong>重定向</strong> 会发出两个 htpp 请求，request 域对象是无效的，因为它不是同一个request对象</li><li>转发和重定向区别：<ul><li>用法不同<br>给服务器用的直接从资源名开始写，给浏览器用的要把应用名写上</li><li>范围不同<br>转发是服务器跳转只能去往当前web应用的资源<br>重定向是服务器跳转，可以去往任何的资源</li><li>传递的类型不同<br>转发的request 对象可以传递各种类型的数据，包括对象<br>重定向只能传递字符串</li></ul></li><li>跳转的时间不同<ul><li>转发时：执行到跳转语句时就会立刻跳转</li><li>重定向：整个页面执行完之后才执行跳转</li></ul></li><li>请求是不一样的<ul><li>转发是带着转发前的请求参数的</li><li>重定向是新的请求</li></ul></li></ol><h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>指某些网站为了辨别用户身份而储存在用户本地终端（Client Side）上的数据（通常经过加密）<br>Cookie 总是保存在客户端中，按在客户端的存储位置，分为内存Cookie 和硬盘Cookie</p><ol><li>内存 Cookie<br>由浏览器维护，保存在内存中，浏览器关闭后就消失了，其存在时间是短暂的</li><li>硬盘 Cookie<br>保存在硬盘里，有一个过期时间，除非用户手工清理或到了过期时间，硬盘Cookie不会被删除，其存在时间是长期的</li></ol><p>Cookie 流程<br>浏览器访问服务器，如果服务器需要记录该用户的状态，就使用response向浏览器发送一个Cookie，浏览器会把Cookie保存起来。当浏览器再次访问服务器的时候，浏览器会把请求的网址连同Cookie一同交给服务器。</p><p>Cookie API</p><ul><li>Cookie类用于创建一个Cookie对象</li><li>response接口中定义了一个addCookie方法，它用于在其响应头中增加一个相应的Set-Cookie头字段</li><li>request接口中定义了一个getCookies方法，它用于获取客户端提交的Cookie</li></ul><p>常用的Cookie方法：</p><ul><li>public Cookie(String name,String value)</li><li>setValue与getValue方法</li><li>setMaxAge与getMaxAge方法 设置Cookie 的有效性</li><li>setPath与getPath方法 设置Cookie成仅某个文件可用</li><li>setDomain与getDomain方法 设置Cookie 域名</li><li>getName方法</li></ul><h4 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h4><p>会话（session）是一种持久网络协议，在用户（或用户代理）端和服务器端之间创建关联，从而起到交换数据包的作用机制。是另一种记录浏览器状态的机制。<br>不同的是Cookie保存在浏览器中，Session保存在服务器中。</p><p>Session API</p><ul><li>long getCreationTime();【获取Session被创建时间】</li><li>String getId();【获取Session的id】</li><li>long getLastAccessedTime();【返回Session最后活跃的时间】</li><li>ServletContext getServletContext();【获取ServletContext对象】</li><li>void setMaxInactiveInterval(int var1);【设置Session超时时间】</li><li>int getMaxInactiveInterval();【获取Session超时时间】</li><li>Object getAttribute(String var1);【获取Session属性】</li><li>Enumeration<string>getAttributeNames();【获取Session所有的属性名】</string></li><li>void setAttribute(String var1, Object var2);【设置Session属性】</li><li>void removeAttribute(String var1);【移除Session属性】</li><li>void invalidate();【销毁该Session】</li><li>boolean isNew();【该Session是否为新的】</li></ul><p>附上 Servlet 学习资源</p><ul><li><a href="https://segmentfault.com/a/1190000013124026" target="_blank" rel="external">Servlet第一篇【介绍Servlet、HTTP协议、WEB目录结构、编写入门Servlet程序、Servlet生命周期】</a></li><li><a href="https://segmentfault.com/a/1190000013124143" target="_blank" rel="external">Servlet第二篇【Servlet调用图、Servlet细节、ServletConfig、ServletContext】</a></li><li><a href="https://segmentfault.com/a/1190000013126031" target="_blank" rel="external">Servlet第三篇【request和response简介、response的常见应用】</a></li><li><a href="https://segmentfault.com/a/1190000013162330" target="_blank" rel="external">Servlet第四篇【request对象常用方法、应用】</a></li><li><a href="https://segmentfault.com/a/1190000013129480" target="_blank" rel="external">Servlet第五篇【介绍会话技术、Cookie的API、详解、应用】</a></li><li><a href="https://segmentfault.com/a/1190000013130309" target="_blank" rel="external">Servlet第六篇【Session介绍、API、生命周期、应用、与Cookie区别】</a></li></ul><h4 id="Cookie-和-Session-的区别"><a href="#Cookie-和-Session-的区别" class="headerlink" title="Cookie 和 Session 的区别"></a>Cookie 和 Session 的区别</h4><ol><li>从存储方式上比较快<ul><li>Cookie 只能存储字符串，存储非ASCII字符串还需要对其编码</li><li>Session 可以存储任何类型的数据</li></ul></li><li>从隐私安全上比较<ul><li>Cookie 存储在浏览器中，对客户端是可见的，信息容易泄露</li><li>Session 存储在服务器中，对客户端是透明的</li></ul></li><li>从有效期上比较<ul><li>Cookie 存储在硬盘中，只需要设置maxAge为大的正数，关闭浏览器，Cookie 还是存在、</li><li>Session 存储在服务器中，设置了 maxInactiveInterval 属性来确定Session的有效期，并且Session依赖于JSESSIONID的 Cookie，Cookie默认的maxAge属性值为-1</li></ul></li><li>从对服务器的负担比较<ul><li>Session 保存在服务器中，每个用户都会产生一个Session，如果并发访问的用户非常多，是不能使用 Session 的，Session 会消耗大量的内存</li><li>Cookie 是保存在和客户端的。不占用服务器资源</li></ul></li><li>从浏览器的支持上比较<ul><li>如果浏览器禁用了Cookie，那么Cookie 是无用的</li><li>如果浏览器禁用了Cookie，Session 可以通过URL地址重写等技术来进行会话跟踪</li></ul></li><li>从跨域名上比较<ul><li>Cookie 可以设置domain属性来实现跨域名</li><li>Session 只在当前的域名内有效，不可跨域名</li></ul></li><li>详细区别<ul><li><a href="https://juejin.im/entry/5766c29d6be3ff006a31b84e" target="_blank" rel="external">Cookie 与 Session 的区别</a></li></ul></li></ol><h3 id="JAVA-EE-架构"><a href="#JAVA-EE-架构" class="headerlink" title="JAVA EE 架构"></a>JAVA EE 架构</h3><p>这里使用的是 JAVA EE 三层架构，具体可以看上一篇文章 <a href="https://www.huizhe.xyz/javaee/">JAVA EE 软件开发体系架构</a></p><h3 id="配置-Tomcat"><a href="#配置-Tomcat" class="headerlink" title="配置 Tomcat"></a>配置 Tomcat</h3><p>Idea 配置 Tomcat ，可以参考文章开头的博客进行设置。</p><h3 id="Artifacts-项目部署"><a href="#Artifacts-项目部署" class="headerlink" title="Artifacts 项目部署"></a>Artifacts 项目部署</h3><p>这里部署直接参考以下博文<br><a href="https://www.cnblogs.com/deng-cc/p/6416332.html" target="_blank" rel="external">理解 IntelliJ IDEA 的项目配置和Web部署</a></p><p>提取了博文的注意点:<br>实际上，当你点击运行tomcat时，默认就开始做以下事情：</p><ul><li>编译，IDEA在保存/自动保存后不会做编译，不像Eclipse的保存即编译，因此在运行server前会做一次编译。编译后class文件存放在指定的项目编译输出目录下</li><li>根据artifact中的设定对目录结构进行创建</li><li>拷贝web资源的根目录下的所有文件到artifact的目录下</li><li>拷贝编译输出目录下的classes目录到artifact下的WEB-INF下</li><li>拷贝lib目录下所需的jar包到artifact下的WEB_INF下</li><li>运行server，运行成功后，如有需要，会自动打开浏览器访问指定url</li></ul><h3 id="踩的几个坑"><a href="#踩的几个坑" class="headerlink" title="踩的几个坑"></a>踩的几个坑</h3><p>因为是刚入门 Java EE，所以踩的坑基本都是配置问题</p><ol><li>项目的创建和导入项目<ul><li>创建项目时，文件结构没有设置好，导致创建后，文件编译输出的文件夹错乱</li><li>导入的jar包，没有经过筛选，直接丢包，浪费一些资源空间</li><li>导入项目的时候，没有配置好 Modules 等，导致项目无法运行</li></ul></li><li>编译版本问题<br>最初是因为偷懒，直接用的集成软件 Jspstudy。Jspstudy只有Tomcat 6 和 7，而笔者用的是 JDK 1.8，所以Tomcat运行不起来，后面采取官网下的Tomcat 9</li><li>架构代码的不合理<br>项目练习采用的是 三层架构，不过我犯了错误，将逻辑层的代码嵌入到了表示层。然后就被教育了。</li><li>单元测试不合理<ul><li>单元测试用的是Junit4，测试的是DAO，而不是Service</li><li>单元测试只是简单的测试代码能否运行，没有进行举例和断言</li><li>Servlet 用PostMan测试，但没有形成一份测试文档</li></ul></li><li>项目的发布<ul><li>在对Tomcat进行配置的时候，没有设置好 url 访问的根目录，所以放进 Tomcat 的webapps目录下后，网站运行起来，各种的访问路径问题</li><li>对 Tomcat 进行多站点配置的时候，配置文件一直报错</li></ul></li></ol><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ol><li><a href="https://www.cnblogs.com/junhuawang/p/6610969.html" target="_blank" rel="external">IDea发布JavaWeb项目 详解一</a></li><li><a href="https://segmentfault.com/a/1190000013124026" target="_blank" rel="external">Servlet第一篇【介绍Servlet、HTTP协议、WEB目录结构、编写入门Servlet程序、Servlet生命周期】</a></li><li><a href="https://segmentfault.com/a/1190000013124143" target="_blank" rel="external">Servlet第二篇【Servlet调用图、Servlet细节、ServletConfig、ServletContext】</a></li><li><a href="https://segmentfault.com/a/1190000013126031" target="_blank" rel="external">Servlet第三篇【request和response简介、response的常见应用】</a></li><li><a href="https://segmentfault.com/a/1190000013162330" target="_blank" rel="external">Servlet第四篇【request对象常用方法、应用】</a></li><li><a href="https://segmentfault.com/a/1190000013129480" target="_blank" rel="external">Servlet第五篇【介绍会话技术、Cookie的API、详解、应用】</a></li><li><a href="https://segmentfault.com/a/1190000013130309" target="_blank" rel="external">Servlet第六篇【Session介绍、API、生命周期、应用、与Cookie区别</a></li><li><a href="https://juejin.im/entry/5766c29d6be3ff006a31b84e" target="_blank" rel="external">Cookie 与 Session 的区别</a></li><li><a href="https://www.cnblogs.com/deng-cc/p/6416332.html" target="_blank" rel="external">理解 IntelliJ IDEA 的项目配置和Web部署</a></li><li><a href="https://my.oschina.net/lujianing/blog/186737" target="_blank" rel="external">IntelliJ IDEA WEB项目的部署配置</a></li></ol></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>你的一点支持是我最大的动力，感谢你的支持！</div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="https://static.huizhe.xyz/article-images/wechatpay.jpg" alt="灰者 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="https://static.huizhe.xyz/article-images/alipay.jpg" alt="灰者 支付宝"><p>支付宝</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> 灰者</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://www.huizhe.xyz/javaProject/" title="记一次踩坑过程—非Maven项目">https://www.huizhe.xyz/javaProject/</a></li><li class="post-copyright-license"><strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://huizhe1.gitHub.io" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/JAVA/" rel="tag"># JAVA</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/javaee/" rel="next" title="JAVA EE 软件开发体系架构"><i class="fa fa-chevron-left"></i> JAVA EE 软件开发体系架构</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/hibernate/" rel="prev" title="Hibernate之Criteria">Hibernate之Criteria<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zMTMyMy83ODcy"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/mylogo.jpg" alt="灰者"><p class="site-author-name" itemprop="name">灰者</p><p class="site-description motion-element" itemprop="description">命运常以痛为吻，我们仍要报之以歌，情深义重</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">7</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/huizhe1" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:a22783276@163.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://plus.google.com/117957303112405695959" target="_blank" title="Google"><i class="fa fa-fw fa-google"></i> Google</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建项目"><span class="nav-number">1.</span> <span class="nav-text">创建项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Servlet"><span class="nav-number">2.</span> <span class="nav-text">Servlet</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP-协议"><span class="nav-number">2.1.</span> <span class="nav-text">HTTP 协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP-请求报文"><span class="nav-number">2.2.</span> <span class="nav-text">HTTP 请求报文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP-响应报文"><span class="nav-number">2.3.</span> <span class="nav-text">HTTP 响应报文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HttpServletRequest-对象"><span class="nav-number">2.4.</span> <span class="nav-text">HttpServletRequest 对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HttpServletResponse-对象"><span class="nav-number">2.5.</span> <span class="nav-text">HttpServletResponse 对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#转发和重定向"><span class="nav-number">2.6.</span> <span class="nav-text">转发和重定向</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cookie"><span class="nav-number">2.7.</span> <span class="nav-text">Cookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Session"><span class="nav-number">2.8.</span> <span class="nav-text">Session</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cookie-和-Session-的区别"><span class="nav-number">2.9.</span> <span class="nav-text">Cookie 和 Session 的区别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JAVA-EE-架构"><span class="nav-number">3.</span> <span class="nav-text">JAVA EE 架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置-Tomcat"><span class="nav-number">4.</span> <span class="nav-text">配置 Tomcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Artifacts-项目部署"><span class="nav-number">5.</span> <span class="nav-text">Artifacts 项目部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#踩的几个坑"><span class="nav-number">6.</span> <span class="nav-text">踩的几个坑</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考"><span class="nav-number">7.</span> <span class="nav-text">参考</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017-2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">huizhe</span></div><div class="theme-info">备案：<a class="theme-link" target="_blank" href="http://www.miitbeian.gov.cn">粤ICP备17125914号</a></div><div><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>本站总访问量<span id="busuanzi_value_site_pv"></span> 次&nbsp|&nbsp 本站访客数<span id="busuanzi_value_site_uv"></span>人次</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script src="/js/src/utils.js?v=5.1.3"></script><script src="/js/src/motion.js?v=5.1.3"></script><script src="/js/src/scrollspy.js?v=5.1.3"></script><script src="/js/src/post-details.js?v=5.1.3"></script><script src="/js/src/bootstrap.js?v=5.1.3"></script><script>!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script><script>// Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });</script><script>function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function ({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', `/classes/Counter/${counter.objectId}`, JSON.stringify({ time: { "__op":"Increment", "amount":1 } }))
            
            .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.time + 1);
            })
            
            .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
            })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1}))
                .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function () {
                  console.log('Failed to create');
                });
            
          }
        })
      .fail(function ({ responseJSON }) {
        console.log('LeanCloud Counter Error:' + responseJSON.code + " " + responseJSON.error);
      });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + "uO3UNSROyYwoFkpDBx7A6nBs-gzGzoHsz")
        .done(function ({ api_server }) {
          var Counter = function (method, url, data) {
            return $.ajax({
              method: method,
              url: `https://${api_server}/1.1${url}`,
              headers: {
                'X-LC-Id': "uO3UNSROyYwoFkpDBx7A6nBs-gzGzoHsz",
                'X-LC-Key': "kUDFwWRFOx1lQbjHOz7oSVDD",
                'Content-Type': 'application/json',
              },
              data: data,
            });
          };
          
          addCount(Counter);
          
        })
    });</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script></body></html>